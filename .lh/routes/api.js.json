{
    "sourceFile": "routes/api.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 25,
            "patches": [
                {
                    "date": 1648214737582,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1648215711725,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,22 +1,25 @@\n const express = require('express');\n const router = express.Router();\n const NotifDb = require('../models/notif');\n-const IdeasDb = require('../models/ideas');\n const {check, validationResult, sanitizeBody} = require('express-validator');\n const NotesController = require('../controllers/NotesController');\n-const ideasController = require('../controllers/IdeasController');\n \n-/** Check API Status **/\n router.get('/status', function (req, res) {\n   res.send({type: 'GET'})\n });\n \n-\n-/** Memos Routes **/\n router.get('/memos', NotesController.notes_index);\n \n-router.get('/memo/:id', NotesController.note_one);\n+router.get('/memo/:id', function (req, res) {\n+  NotifDb.findOne({_id: req.params.id})\n+      .then(result => {\n+        res.send(result);\n+      })\n+      .catch(err => {\n+        console.log(err);\n+      });\n+});\n \n router.post('/memo', [\n       check('name').custom(async value => {\n         const checkName = await NotifDb.findOne({name: value})\n@@ -26,25 +29,12 @@\n );\n \n router.put('/memo/:id', NotesController.update_note);\n \n-router.delete('/memo/:id', NotesController.delete_note);\n-/** End  Memos **/\n+router.delete('/memo/:id', function (req, res) {\n+  NotifDb.findByIdAndDelete({_id: req.params.id}).then(function (item) {\n+    res.send(item)\n+  });\n \n-/** Ideas Routes **/\n-router.get('/ideas', ideasController.ideas_index);\n-\n-router.get('/ideas/:id', ideasController.ideas_one);\n-\n-router.post('/idea', [\n-    check('group').custom(async value => {\n-      const checkName = await IdeasDb.findOne({group: value})\n-      if(checkName) return Promise.reject('Name already taken')\n-    }),\n-  ], ideasController.idea_view\n-);\n-\n-router.put('/idea/:id', ideasController.update_idea);\n-\n-router.delete('/idea/:id', ideasController.delete_idea);\n-nodemon\n+});\n+heroku \n module.exports = router;\n"
                },
                {
                    "date": 1648217536077,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,25 +1,26 @@\n const express = require('express');\n const router = express.Router();\n const NotifDb = require('../models/notif');\n+const IdeasDb = require('../models/ideas');\n const {check, validationResult, sanitizeBody} = require('express-validator');\n const NotesController = require('../controllers/NotesController');\n+const ideasController = require('../controllers/IdeasController');\n \n+/** Check API Status **/\n router.get('/status', function (req, res) {\n   res.send({type: 'GET'})\n });\n \n+\n+\n+\n+\n+\n+/** Memos Routes **/\n router.get('/memos', NotesController.notes_index);\n \n-router.get('/memo/:id', function (req, res) {\n-  NotifDb.findOne({_id: req.params.id})\n-      .then(result => {\n-        res.send(result);\n-      })\n-      .catch(err => {\n-        console.log(err);\n-      });\n-});\n+router.get('/memo/:id', NotesController.note_one);\n \n router.post('/memo', [\n       check('name').custom(async value => {\n         const checkName = await NotifDb.findOne({name: value})\n@@ -29,12 +30,25 @@\n );\n \n router.put('/memo/:id', NotesController.update_note);\n \n-router.delete('/memo/:id', function (req, res) {\n-  NotifDb.findByIdAndDelete({_id: req.params.id}).then(function (item) {\n-    res.send(item)\n-  });\n+router.delete('/memo/:id', NotesController.delete_note);\n+/** End  Memos **/\n \n-});\n-heroku \n+/** Ideas Routes **/\n+router.get('/ideas', ideasController.ideas_index);\n+\n+router.get('/ideas/:id', ideasController.ideas_one);\n+\n+router.post('/idea', [\n+    check('group').custom(async value => {\n+      const checkName = await IdeasDb.findOne({group: value})\n+      if(checkName) return Promise.reject('Name already taken')\n+    }),\n+  ], ideasController.idea_view\n+);\n+\n+router.put('/idea/:id', ideasController.update_idea);\n+\n+router.delete('/idea/:id', ideasController.delete_idea);\n+\n module.exports = router;\n"
                },
                {
                    "date": 1648217557251,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n const express = require('express');\n const router = express.Router();\n+\n const NotifDb = require('../models/notif');\n const IdeasDb = require('../models/ideas');\n const {check, validationResult, sanitizeBody} = require('express-validator');\n const NotesController = require('../controllers/NotesController');\n"
                },
                {
                    "date": 1648217570758,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n const express = require('express');\n const router = express.Router();\n+const passport = require('passport');\n \n const NotifDb = require('../models/notif');\n const IdeasDb = require('../models/ideas');\n const {check, validationResult, sanitizeBody} = require('express-validator');\n"
                },
                {
                    "date": 1648217586719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,12 +13,23 @@\n   res.send({type: 'GET'})\n });\n \n \n+router.post(\n+  '/signup',\n+  passport.authenticate('signup', { session: false }),\n+  async (req, res, next) => {\n+    res.json({\n+      message: 'Signup successful',\n+      user: req.user\n+    });\n+  }\n+);\n \n \n \n \n+\n /** Memos Routes **/\n router.get('/memos', NotesController.notes_index);\n \n router.get('/memo/:id', NotesController.note_one);\n"
                },
                {
                    "date": 1648217593982,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,9 +12,9 @@\n router.get('/status', function (req, res) {\n   res.send({type: 'GET'})\n });\n \n-\n+/** Check API Status **/\n router.post(\n   '/signup',\n   passport.authenticate('signup', { session: false }),\n   async (req, res, next) => {\n"
                },
                {
                    "date": 1648217606797,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,9 +12,9 @@\n router.get('/status', function (req, res) {\n   res.send({type: 'GET'})\n });\n \n-/** Check API Status **/\n+/** Signup **/\n router.post(\n   '/signup',\n   passport.authenticate('signup', { session: false }),\n   async (req, res, next) => {\n"
                },
                {
                    "date": 1648217626054,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n const express = require('express');\n const router = express.Router();\n const passport = require('passport');\n-\n+const jwt = require('jsonwebtoken');\n const NotifDb = require('../models/notif');\n const IdeasDb = require('../models/ideas');\n const {check, validationResult, sanitizeBody} = require('express-validator');\n const NotesController = require('../controllers/NotesController');\n"
                },
                {
                    "date": 1648217648534,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,12 +24,43 @@\n     });\n   }\n );\n \n+router.post(\n+  '/login',\n+  async (req, res, next) => {\n+    passport.authenticate(\n+      'login',\n+      async (err, user, info) => {\n+        try {\n+          if (err || !user) {\n+            const error = new Error('An error occurred.');\n \n+            return next(error);\n+          }\n \n+          req.login(\n+            user,\n+            { session: false },\n+            async (error) => {\n+              if (error) return next(error);\n \n+              const body = { _id: user._id, email: user.email };\n+              const token = jwt.sign({ user: body }, 'TOP_SECRET');\n \n+              return res.json({ token });\n+            }\n+          );\n+        } catch (error) {\n+          return next(error);\n+        }\n+      }\n+    )(req, res, next);\n+  }\n+);\n+\n+\n+\n /** Memos Routes **/\n router.get('/memos', NotesController.notes_index);\n \n router.get('/memo/:id', NotesController.note_one);\n"
                },
                {
                    "date": 1648217653972,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -58,9 +58,8 @@\n   }\n );\n \n \n-\n /** Memos Routes **/\n router.get('/memos', NotesController.notes_index);\n \n router.get('/memo/:id', NotesController.note_one);\n"
                },
                {
                    "date": 1648217695702,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,8 +24,9 @@\n     });\n   }\n );\n \n+/** Signup **/\n router.post(\n   '/login',\n   async (req, res, next) => {\n     passport.authenticate(\n"
                },
                {
                    "date": 1648217846476,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,15 +3,15 @@\n const passport = require('passport');\n const jwt = require('jsonwebtoken');\n const NotifDb = require('../models/notif');\n const IdeasDb = require('../models/ideas');\n-const {check, validationResult, sanitizeBody} = require('express-validator');\n+const { check, validationResult, sanitizeBody } = require('express-validator');\n const NotesController = require('../controllers/NotesController');\n const ideasController = require('../controllers/IdeasController');\n \n /** Check API Status **/\n router.get('/status', function (req, res) {\n-  res.send({type: 'GET'})\n+  res.send({ type: 'GET' })\n });\n \n /** Signup **/\n router.post(\n@@ -24,9 +24,9 @@\n     });\n   }\n );\n \n-/** Signup **/\n+/** Login **/\n router.post(\n   '/login',\n   async (req, res, next) => {\n     passport.authenticate(\n@@ -65,13 +65,13 @@\n \n router.get('/memo/:id', NotesController.note_one);\n \n router.post('/memo', [\n-      check('name').custom(async value => {\n-        const checkName = await NotifDb.findOne({name: value})\n-        if(checkName) return Promise.reject('Name already taken')\n-      }),\n-    ], NotesController.note_view\n+  check('name').custom(async value => {\n+    const checkName = await NotifDb.findOne({ name: value })\n+    if (checkName) return Promise.reject('Name already taken')\n+  }),\n+], NotesController.note_view\n );\n \n router.put('/memo/:id', NotesController.update_note);\n \n@@ -83,13 +83,13 @@\n \n router.get('/ideas/:id', ideasController.ideas_one);\n \n router.post('/idea', [\n-    check('group').custom(async value => {\n-      const checkName = await IdeasDb.findOne({group: value})\n-      if(checkName) return Promise.reject('Name already taken')\n-    }),\n-  ], ideasController.idea_view\n+  check('group').custom(async value => {\n+    const checkName = await IdeasDb.findOne({ group: value })\n+    if (checkName) return Promise.reject('Name already taken')\n+  }),\n+], ideasController.idea_view\n );\n \n router.put('/idea/:id', ideasController.update_idea);\n \n"
                },
                {
                    "date": 1648217944925,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,8 +7,9 @@\n const { check, validationResult, sanitizeBody } = require('express-validator');\n const NotesController = require('../controllers/NotesController');\n const ideasController = require('../controllers/IdeasController');\n \n+require('./auth/auth');\n /** Check API Status **/\n router.get('/status', function (req, res) {\n   res.send({ type: 'GET' })\n });\n"
                },
                {
                    "date": 1648217951252,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,10 @@\n const { check, validationResult, sanitizeBody } = require('express-validator');\n const NotesController = require('../controllers/NotesController');\n const ideasController = require('../controllers/IdeasController');\n \n-require('./auth/auth');\n+require('../auth/auth');\n+\n /** Check API Status **/\n router.get('/status', function (req, res) {\n   res.send({ type: 'GET' })\n });\n"
                },
                {
                    "date": 1648218654057,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,13 +9,10 @@\n const ideasController = require('../controllers/IdeasController');\n \n require('../auth/auth');\n \n-/** Check API Status **/\n-router.get('/status', function (req, res) {\n-  res.send({ type: 'GET' })\n-});\n \n+\n /** Signup **/\n router.post(\n   '/signup',\n   passport.authenticate('signup', { session: false }),\n"
                },
                {
                    "date": 1648227561433,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,8 +32,10 @@\n       'login',\n       async (err, user, info) => {\n         try {\n           if (err || !user) {\n+            console.log('');\n+            \n             const error = new Error('An error occurred.');\n \n             return next(error);\n           }\n"
                },
                {
                    "date": 1648227567664,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n       'login',\n       async (err, user, info) => {\n         try {\n           if (err || !user) {\n-            console.log('');\n+            console.log('err', err);\n             \n             const error = new Error('An error occurred.');\n \n             return next(error);\n"
                },
                {
                    "date": 1648227607780,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n       'login',\n       async (err, user, info) => {\n         try {\n           if (err || !user) {\n-            console.log('err', err);\n+            console.log('err', err, user);\n             \n             const error = new Error('An error occurred.');\n \n             return next(error);\n"
                },
                {
                    "date": 1648299197025,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,9 +56,9 @@\n           return next(error);\n         }\n       }\n     )(req, res, next);\n-  }\n+  }~\n );\n \n \n /** Memos Routes **/\n"
                },
                {
                    "date": 1648299220188,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,9 +56,9 @@\n           return next(error);\n         }\n       }\n     )(req, res, next);\n-  }~\n+  }\n );\n \n \n /** Memos Routes **/\n"
                },
                {
                    "date": 1648299962804,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n       'login',\n       async (err, user, info) => {\n         try {\n           if (err || !user) {\n-            console.log('err', err, user);\n+            console.log('err 01', err, user);\n             \n             const error = new Error('An error occurred.');\n \n             return next(error);\n"
                },
                {
                    "date": 1649091161246,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,22 +1,30 @@\n const express = require('express');\n const router = express.Router();\n const passport = require('passport');\n const jwt = require('jsonwebtoken');\n-const NotifDb = require('../models/notif');\n const IdeasDb = require('../models/ideas');\n-const { check, validationResult, sanitizeBody } = require('express-validator');\n+const {check, validationResult, sanitizeBody} = require('express-validator');\n const NotesController = require('../controllers/NotesController');\n const ideasController = require('../controllers/IdeasController');\n \n require('../auth/auth');\n \n \n+router.get('/status', function (req, res) {\n+  //res.send({ type: 'GET' })\n+  res.send({\n+    message: 'You made it to the secure route',\n+    user: req.user,\n+    token: req.query.secret_token\n+  })\n+});\n \n+\n /** Signup **/\n router.post(\n   '/signup',\n-  passport.authenticate('signup', { session: false }),\n+  passport.authenticate('signup', {session: false}),\n   async (req, res, next) => {\n     res.json({\n       message: 'Signup successful',\n       user: req.user\n@@ -33,24 +41,24 @@\n       async (err, user, info) => {\n         try {\n           if (err || !user) {\n             console.log('err 01', err, user);\n-            \n+\n             const error = new Error('An error occurred.');\n \n             return next(error);\n           }\n \n           req.login(\n             user,\n-            { session: false },\n+            {session: false},\n             async (error) => {\n               if (error) return next(error);\n \n-              const body = { _id: user._id, email: user.email };\n-              const token = jwt.sign({ user: body }, 'TOP_SECRET');\n+              const body = {_id: user._id, email: user.email};\n+              const token = jwt.sign({user: body}, 'TOP_SECRET');\n \n-              return res.json({ token });\n+              return res.json({success: true, token});\n             }\n           );\n         } catch (error) {\n           return next(error);\n@@ -60,37 +68,19 @@\n   }\n );\n \n \n-/** Memos Routes **/\n-router.get('/memos', NotesController.notes_index);\n-\n-router.get('/memo/:id', NotesController.note_one);\n-\n-router.post('/memo', [\n-  check('name').custom(async value => {\n-    const checkName = await NotifDb.findOne({ name: value })\n-    if (checkName) return Promise.reject('Name already taken')\n-  }),\n-], NotesController.note_view\n-);\n-\n-router.put('/memo/:id', NotesController.update_note);\n-\n-router.delete('/memo/:id', NotesController.delete_note);\n-/** End  Memos **/\n-\n /** Ideas Routes **/\n router.get('/ideas', ideasController.ideas_index);\n \n router.get('/ideas/:id', ideasController.ideas_one);\n \n router.post('/idea', [\n-  check('group').custom(async value => {\n-    const checkName = await IdeasDb.findOne({ group: value })\n-    if (checkName) return Promise.reject('Name already taken')\n-  }),\n-], ideasController.idea_view\n+    check('group').custom(async value => {\n+      const checkName = await IdeasDb.findOne({group: value})\n+      if (checkName) return Promise.reject('Name already taken')\n+    }),\n+  ], ideasController.idea_view\n );\n \n router.put('/idea/:id', ideasController.update_idea);\n \n"
                },
                {
                    "date": 1649091174556,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,8 @@\n const passport = require('passport');\n const jwt = require('jsonwebtoken');\n const IdeasDb = require('../models/ideas');\n const {check, validationResult, sanitizeBody} = require('express-validator');\n-const NotesController = require('../controllers/NotesController');\n const ideasController = require('../controllers/IdeasController');\n \n require('../auth/auth');\n \n"
                },
                {
                    "date": 1649091193016,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,10 +3,10 @@\n const passport = require('passport');\n const jwt = require('jsonwebtoken');\n const IdeasDb = require('../models/ideas');\n const {check, validationResult, sanitizeBody} = require('express-validator');\n-const ideasController = require('../controllers/IdeasController');\n \n+\n require('../auth/auth');\n \n \n router.get('/status', function (req, res) {\n@@ -67,22 +67,7 @@\n   }\n );\n \n \n-/** Ideas Routes **/\n-router.get('/ideas', ideasController.ideas_index);\n \n-router.get('/ideas/:id', ideasController.ideas_one);\n \n-router.post('/idea', [\n-    check('group').custom(async value => {\n-      const checkName = await IdeasDb.findOne({group: value})\n-      if (checkName) return Promise.reject('Name already taken')\n-    }),\n-  ], ideasController.idea_view\n-);\n-\n-router.put('/idea/:id', ideasController.update_idea);\n-\n-router.delete('/idea/:id', ideasController.delete_idea);\n-\n module.exports = router;\n"
                },
                {
                    "date": 1649144957214,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,12 +39,9 @@\n       'login',\n       async (err, user, info) => {\n         try {\n           if (err || !user) {\n-            console.log('err 01', err, user);\n-\n             const error = new Error('An error occurred.');\n-\n             return next(error);\n           }\n \n           req.login(\n@@ -66,8 +63,5 @@\n     )(req, res, next);\n   }\n );\n \n-\n-\n-\n module.exports = router;\n"
                }
            ],
            "date": 1648214737581,
            "name": "Commit-0",
            "content": "const express = require('express');\nconst router = express.Router();\nconst NotifDb = require('../models/notif');\nconst IdeasDb = require('../models/ideas');\nconst {check, validationResult, sanitizeBody} = require('express-validator');\nconst NotesController = require('../controllers/NotesController');\nconst ideasController = require('../controllers/IdeasController');\n\n/** Check API Status **/\nrouter.get('/status', function (req, res) {\n  res.send({type: 'GET'})\n});\n\n\n/** Memos Routes **/\nrouter.get('/memos', NotesController.notes_index);\n\nrouter.get('/memo/:id', NotesController.note_one);\n\nrouter.post('/memo', [\n      check('name').custom(async value => {\n        const checkName = await NotifDb.findOne({name: value})\n        if(checkName) return Promise.reject('Name already taken')\n      }),\n    ], NotesController.note_view\n);\n\nrouter.put('/memo/:id', NotesController.update_note);\n\nrouter.delete('/memo/:id', NotesController.delete_note);\n/** End  Memos **/\n\n/** Ideas Routes **/\nrouter.get('/ideas', ideasController.ideas_index);\n\nrouter.get('/ideas/:id', ideasController.ideas_one);\n\nrouter.post('/idea', [\n    check('group').custom(async value => {\n      const checkName = await IdeasDb.findOne({group: value})\n      if(checkName) return Promise.reject('Name already taken')\n    }),\n  ], ideasController.idea_view\n);\n\nrouter.put('/idea/:id', ideasController.update_idea);\n\nrouter.delete('/idea/:id', ideasController.delete_idea);\nnodemon\nmodule.exports = router;\n"
        }
    ]
}