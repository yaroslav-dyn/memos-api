{
    "sourceFile": "index.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 19,
            "patches": [
                {
                    "date": 1648218197424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1648218205820,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,9 +33,9 @@\n \n mongoose.Promise = global.Promise;\n \n app.use(cors())\n-app.use(bodyParser.urlencoded({ extended: false }));\n+app.use(bodyParser.urlencoded({ extended: false }) );\n \n //initialize routes\n app.use('/api', require('./routes/api'));\n \n"
                },
                {
                    "date": 1648218289744,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n const express = require('express')\n const bodyParser = require('body-parser');\n const mongoose = require('mongoose');\n const cors = require('cors');\n+const passport = require('passport');\n \n //app setup\n const app = express();\n \n@@ -33,9 +34,9 @@\n \n mongoose.Promise = global.Promise;\n \n app.use(cors())\n-app.use(bodyParser.urlencoded({ extended: false }) );\n+app.use( bodyParser.urlencoded({ extended: false }) );\n \n //initialize routes\n app.use('/api', require('./routes/api'));\n \n"
                },
                {
                    "date": 1648218301215,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,18 @@\n \n //initialize routes\n app.use('/api', require('./routes/api'));\n \n+// Plug in the JWT strategy as a middleware so only verified users can access this route.\n+app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n+// Handle errors.\n+app.use(function (err, req, res, next) {\n+  res.status(err.status || 500);\n+  res.json({ error: err });\n+});\n+\n+\n //error handler\n \n app.use(function (err, req, res, next) {\n   console.log(err);\n"
                },
                {
                    "date": 1648218445916,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,8 +36,11 @@\n \n app.use(cors())\n app.use( bodyParser.urlencoded({ extended: false }) );\n \n+const routes = require('./routes/routes');\n+const secureRoute = require('./routes/secure-routes');\n+\n //initialize routes\n app.use('/api', require('./routes/api'));\n \n // Plug in the JWT strategy as a middleware so only verified users can access this route.\n@@ -50,9 +53,8 @@\n });\n \n \n //error handler\n-\n app.use(function (err, req, res, next) {\n   console.log(err);\n \n   res.status(422).send({error: err.message});\n"
                },
                {
                    "date": 1648218452004,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,9 +40,9 @@\n const routes = require('./routes/routes');\n const secureRoute = require('./routes/secure-routes');\n \n //initialize routes\n-app.use('/api', require('./routes/api'));\n+app.use('/api', routes);\n \n // Plug in the JWT strategy as a middleware so only verified users can access this route.\n app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n"
                },
                {
                    "date": 1648218721016,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,9 @@\n \n app.use(cors())\n app.use( bodyParser.urlencoded({ extended: false }) );\n \n-const routes = require('./routes/routes');\n+const routes = require('./routes/api');\n const secureRoute = require('./routes/secure-routes');\n \n //initialize routes\n app.use('/api', routes);\n"
                },
                {
                    "date": 1648224089546,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,8 +35,9 @@\n mongoose.Promise = global.Promise;\n \n app.use(cors())\n app.use( bodyParser.urlencoded({ extended: false }) );\n+app.use(bodyParser.json());\n \n const routes = require('./routes/api');\n const secureRoute = require('./routes/secure-routes');\n \n"
                },
                {
                    "date": 1648226437083,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n mongoose.Promise = global.Promise;\n \n app.use(cors())\n app.use( bodyParser.urlencoded({ extended: false }) );\n-app.use(bodyParser.json());\n+//app.use(bodyParser.json());\n \n const routes = require('./routes/api');\n const secureRoute = require('./routes/secure-routes');\n \n@@ -48,8 +48,9 @@\n app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n // Handle errors.\n app.use(function (err, req, res, next) {\n+  log()\n   res.status(err.status || 500);\n   res.json({ error: err });\n });\n \n"
                },
                {
                    "date": 1648226443152,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,9 +48,9 @@\n app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n // Handle errors.\n app.use(function (err, req, res, next) {\n-  log()\n+  log(err)\n   res.status(err.status || 500);\n   res.json({ error: err });\n });\n \n"
                },
                {
                    "date": 1648226495064,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,9 +48,9 @@\n app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n // Handle errors.\n app.use(function (err, req, res, next) {\n-  log(err)\n+  lo\n   res.status(err.status || 500);\n   res.json({ error: err });\n });\n \n"
                },
                {
                    "date": 1648226504984,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,9 +48,10 @@\n app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n // Handle errors.\n app.use(function (err, req, res, next) {\n-  lo\n+  console.log('err', err);\n+  \n   res.status(err.status || 500);\n   res.json({ error: err });\n });\n \n"
                },
                {
                    "date": 1648226623548,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,9 +48,8 @@\n app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n // Handle errors.\n app.use(function (err, req, res, next) {\n-  console.log('err', err);\n   \n   res.status(err.status || 500);\n   res.json({ error: err });\n });\n"
                },
                {
                    "date": 1648226682157,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,8 +48,9 @@\n app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n // Handle errors.\n app.use(function (err, req, res, next) {\n+  console.log('');\n   \n   res.status(err.status || 500);\n   res.json({ error: err });\n });\n"
                },
                {
                    "date": 1648226703447,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,9 +48,9 @@\n app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n // Handle errors.\n app.use(function (err, req, res, next) {\n-  console.log('');\n+  console.log('err', err);\n   \n   res.status(err.status || 500);\n   res.json({ error: err });\n });\n"
                },
                {
                    "date": 1648227252494,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,10 +48,8 @@\n app.use('/user', passport.authenticate('jwt', { session: false }), secureRoute);\n \n // Handle errors.\n app.use(function (err, req, res, next) {\n-  console.log('err', err);\n-  \n   res.status(err.status || 500);\n   res.json({ error: err });\n });\n \n"
                },
                {
                    "date": 1648299556627,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,10 +34,10 @@\n \n mongoose.Promise = global.Promise;\n \n app.use(cors())\n-app.use( bodyParser.urlencoded({ extended: false }) );\n-//app.use(bodyParser.json());\n+//app.use( bodyParser.urlencoded({ extended: false }) );\n+app.use(bodyParser.json());\n \n const routes = require('./routes/api');\n const secureRoute = require('./routes/secure-routes');\n \n"
                },
                {
                    "date": 1648300121104,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,9 @@\n \n mongoose.Promise = global.Promise;\n \n app.use(cors())\n-//app.use( bodyParser.urlencoded({ extended: false }) );\n+app.use( bodyParser.urlencoded({ extended: false }) );\n app.use(bodyParser.json());\n \n const routes = require('./routes/api');\n const secureRoute = require('./routes/secure-routes');\n"
                },
                {
                    "date": 1648300130106,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n mongoose.Promise = global.Promise;\n \n app.use(cors())\n app.use( bodyParser.urlencoded({ extended: false }) );\n-app.use(bodyParser.json());\n+//app.use(bodyParser.json());\n \n const routes = require('./routes/api');\n const secureRoute = require('./routes/secure-routes');\n \n"
                },
                {
                    "date": 1648301841549,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n mongoose.Promise = global.Promise;\n \n app.use(cors())\n app.use( bodyParser.urlencoded({ extended: false }) );\n-//app.use(bodyParser.json());\n+app.use(bodyParser.json());\n \n const routes = require('./routes/api');\n const secureRoute = require('./routes/secure-routes');\n \n"
                }
            ],
            "date": 1648218197424,
            "name": "Commit-0",
            "content": "const express = require('express')\nconst bodyParser = require('body-parser');\nconst mongoose = require('mongoose');\nconst cors = require('cors');\n\n//app setup\nconst app = express();\n\n//yaroslav-webdev\n//123qwe\n\n//connect to MDB\n//mongodb://localhost/notif\n//mongodb+srv://yaroslav-webdev:123qwe@memo.s7mce.mongodb.net/memo\n\nconst localDb = 'mongodb+srv://yaroslav-webdev:123qwe@memo.s7mce.mongodb.net/memo';\nconst dataDbUrl = process.env.MONGODB_URL || localDb; //localhost/notif\n\nasync function startDb() {\n  try {\n    await mongoose.connect(dataDbUrl, {\n      useNewUrlParser: true,\n      useCreateIndex: true,\n      autoIndex: true\n    });\n    console.log('connection to server DB');\n  } catch(error) {\n    console.log('Error DB', error);\n  }\n}\n\nstartDb();\n\nmongoose.Promise = global.Promise;\n\napp.use(cors())\napp.use(bodyParser.urlencoded({ extended: false }));\n\n//initialize routes\napp.use('/api', require('./routes/api'));\n\n\n//error handler\n\napp.use(function (err, req, res, next) {\n  console.log(err);\n\n  res.status(422).send({error: err.message});\n});\n\nlet API_PORT = process.env.PORT || 4000\n\n\nlet server = app.listen( API_PORT, function () {\n  console.log('Listen app');\n});\n\n//Static files\napp.use(express.static('public'));\n"
        }
    ]
}